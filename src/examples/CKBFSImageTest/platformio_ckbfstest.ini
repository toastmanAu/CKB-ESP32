; CKBFSImageTest — PlatformIO build config for CYD (ESP32-2432S028R)
; Store a JPEG on CKB chain, retrieve, display, send stats to Telegram
;
; Hardware: ESP32-2432S028R (Cheap Yellow Display)
;   - ILI9341 320x240 TFT, SPI
;   - ESP32-D0WD-V3, 4MB flash, 520KB SRAM (no PSRAM)
;
; Flash: pio run -e ckbfstest -t upload
; Monitor: pio device monitor -e ckbfstest

[env:ckbfstest]
platform    = espressif32
board       = esp32dev
framework   = arduino

; Partition: large_app to fit TJpgDec + CKB-ESP32 + TFT_eSPI
board_build.partitions = huge_app.csv

; Upload
upload_speed    = 921600
monitor_speed   = 115200
monitor_filters = esp32_exception_decoder

lib_deps =
    toastmanAu/CKB-ESP32
    toastmanAu/TelegramSerial
    bodmer/TFT_eSPI
    bodmer/TJpgDec
    bitbank2/JPEGENC

; TFT_eSPI — CYD (ESP32-2432S028R) pin config
; These build flags configure TFT_eSPI without editing User_Setup.h
build_flags =
    -DCORE_DEBUG_LEVEL=3
    ; ILI9341 driver
    -DUSER_SETUP_LOADED=1
    -DILI9341_DRIVER=1
    -DTFT_WIDTH=240
    -DTFT_HEIGHT=320
    -DTFT_MISO=12
    -DTFT_MOSI=13
    -DTFT_SCLK=14
    -DTFT_CS=15
    -DTFT_DC=2
    -DTFT_RST=-1
    -DTFT_BL=21
    -DTFT_BACKLIGHT_ON=HIGH
    -DSPI_FREQUENCY=55000000
    -DSPI_READ_FREQUENCY=20000000
    -DSPI_TOUCH_FREQUENCY=2500000
    -DTOUCH_CS=33
    ; JPEG decoder
    -DTJPGD_TBLCLIP=1
